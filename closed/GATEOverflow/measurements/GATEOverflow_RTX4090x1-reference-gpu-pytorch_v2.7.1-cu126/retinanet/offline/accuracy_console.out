python3 python/main.py --profile retinanet-pytorch --model "/home/mlcuser/MLC/repos/local/cache/download-file_get-ml-model-mo_abe3e5c3/resnext50_32x4d_fpn.pth" --dataset-path /home/mlcuser/MLC/repos/local/cache/get-preprocessed-dataset-openimages_bc653348 --output "/home/mlcuser/MLC/repos/local/cache/get-mlperf-inference-results-dir_d5af2b93/valid_results/28895441291d-reference-gpu-pytorch-v2.7.1-cu126/retinanet/offline/accuracy" --scenario Offline --max-batchsize 1 --threads 1 --user_conf /home/mlcuser/MLC/repos/gateoverflow@mlperf-automations/script/generate-mlperf-inference-user-conf/tmp/eeb6f36ff79e403da9e6343e99064016.conf --accuracy --use_preprocessed_dataset --cache_dir /home/mlcuser/MLC/repos/local/cache/get-preprocessed-dataset-openimages_bc653348 --dataset-list /home/mlcuser/MLC/repos/local/cache/get-preprocessed-dataset-openimages_bc653348/annotations/openimages-mlperf.json
INFO:main:Namespace(dataset='openimages-800-retinanet', dataset_path='/home/mlcuser/MLC/repos/local/cache/get-preprocessed-dataset-openimages_bc653348', dataset_list='/home/mlcuser/MLC/repos/local/cache/get-preprocessed-dataset-openimages_bc653348/annotations/openimages-mlperf.json', data_format=None, profile='retinanet-pytorch', scenario='Offline', max_batchsize=1, model='/home/mlcuser/MLC/repos/local/cache/download-file_get-ml-model-mo_abe3e5c3/resnext50_32x4d_fpn.pth', output='/home/mlcuser/MLC/repos/local/cache/get-mlperf-inference-results-dir_d5af2b93/valid_results/28895441291d-reference-gpu-pytorch-v2.7.1-cu126/retinanet/offline/accuracy', inputs=['image'], outputs=['boxes', 'labels', 'scores'], backend='pytorch-native', device=None, model_name='retinanet', threads=1, qps=None, cache=0, cache_dir='/home/mlcuser/MLC/repos/local/cache/get-preprocessed-dataset-openimages_bc653348', preprocessed_dir=None, use_preprocessed_dataset=True, accuracy=True, find_peak_performance=False, debug=False, user_conf='/home/mlcuser/MLC/repos/gateoverflow@mlperf-automations/script/generate-mlperf-inference-user-conf/tmp/eeb6f36ff79e403da9e6343e99064016.conf', audit_conf='audit.config', time=None, count=None, performance_sample_count=None, max_latency=None, samples_per_query=8)
INFO:coco:loaded 24781 images, cache=0, already_preprocessed=True, took=0.6sec
/home/mlcuser/venv/mlc/lib/python3.10/site-packages/torch/serialization.py:1488: UserWarning: 'torch.load' received a zip file that looks like a TorchScript archive dispatching to 'torch.jit.load' (call 'torch.jit.load' directly to silence this warning)
  warnings.warn(
/home/mlcuser/venv/mlc/lib/python3.10/site-packages/torch/nn/modules/module.py:1762: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4314.)
  return forward_call(*args, **kwargs)
code/__torch__/model/retinanet.py:159: UserWarning: RetinaNet always returns a (Losses, Detections) tuple in scripting
INFO:main:starting TestScenario.Offline
loading annotations into memory...
Done (t=1.22s)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(2606191, 7)
0/2606191
1000000/2606191
2000000/2606191
DONE (t=5.96s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=91.15s).
Accumulating evaluation results...
DONE (t=21.16s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.376
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.524
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.406
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.025
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.127
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.415
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.420
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.596
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.623
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.075
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.335
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.675
TestScenario.Offline qps=143.39, mean=0.1067, time=172.823, acc=40.477%, mAP=37.559%, queries=24781, tiles=50.0:0.1089,80.0:0.1143,90.0:0.1172,95.0:0.1196,99.0:0.1243,99.9:0.6332
